import streamlit as st
import pandas as pd

# ---------------------------------------------------
# ãƒšãƒ¼ã‚¸è¨­å®š
# ---------------------------------------------------
st.set_page_config(page_title="KEIBA APPï¼ˆå®‰å®šç‰ˆï¼‰", layout="wide")

st.markdown("## ğŸ KEIBA APP - Stable UI Base")
st.markdown(
    """
    <span style='color:#ff7f00; font-weight:700;'>ã‚¿ãƒ–æ§‹é€ ãƒ†ã‚¹ãƒˆç‰ˆï¼ˆå®‰å®šï¼‰</span><br>
    5ã¤ã®ã‚¿ãƒ–ãã‚Œãã‚Œã«ä¸­èº«ã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹çŠ¶æ…‹ã§ã™ã€‚<br>
    ã‚‚ã—ã‚¿ãƒ–åã—ã‹è¡¨ç¤ºã•ã‚Œãªã„å ´åˆã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚
    """,
    unsafe_allow_html=True,
)

# ---------------------------------------------------
# ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿
# ---------------------------------------------------
demo_rows = [
    {"æ ": 1, "é¦¬ç•ª": 1, "é¦¬å": "ã‚µãƒ³ãƒ—ãƒ«ãƒ›ãƒ¼ã‚¹A", "æ€§é½¢": "ç‰¡4", "é¨æ‰‹": "å·ç”°"},
    {"æ ": 2, "é¦¬ç•ª": 2, "é¦¬å": "ã‚µãƒ³ãƒ—ãƒ«ãƒ›ãƒ¼ã‚¹B", "æ€§é½¢": "ç‰3", "é¨æ‰‹": "ãƒ«ãƒ¡ãƒ¼ãƒ«"},
    {"æ ": 3, "é¦¬ç•ª": 3, "é¦¬å": "ã‚µãƒ³ãƒ—ãƒ«ãƒ›ãƒ¼ã‚¹C", "æ€§é½¢": "ç‰¡5", "é¨æ‰‹": "æ­¦è±Š"},
]
df_demo = pd.DataFrame(demo_rows)

# ---------------------------------------------------
# ã‚¿ãƒ–ç”Ÿæˆ
# ---------------------------------------------------
tab_shutuba, tab_score, tab_ai, tab_baken, tab_info = st.tabs(
    ["å‡ºé¦¬è¡¨", "ã‚¹ã‚³ã‚¢", "AIã‚¹ã‚³ã‚¢", "é¦¬åˆ¸", "åŸºæœ¬æƒ…å ±"]
)

# ---------------------------------------------------
# å‡ºé¦¬è¡¨ã‚¿ãƒ–
# ---------------------------------------------------
with tab_shutuba:
    st.subheader("ğŸ“‹ å‡ºé¦¬è¡¨ã‚¿ãƒ–ï¼ˆä¸­èº«ãƒ†ã‚¹ãƒˆï¼‰")
    st.write("ã“ã“ã«ã¯å‡ºé¦¬è¡¨ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ï¼ˆä»Šã¯ãƒ‡ãƒ¢ï¼‰")
    st.dataframe(df_demo, use_container_width=True)

# ---------------------------------------------------
# ã‚¹ã‚³ã‚¢ã‚¿ãƒ–
# ---------------------------------------------------
with tab_score:
    st.subheader("ğŸ”¢ ã‚¹ã‚³ã‚¢ã‚¿ãƒ–ï¼ˆä¸­èº«ãƒ†ã‚¹ãƒˆï¼‰")
    st.write("ã“ã“ã«ã¯æ‰‹å‹•ã‚¹ã‚³ã‚¢å…¥åŠ›UIãŒå…¥ã‚Šã¾ã™ã€‚ï¼ˆä»Šã¯ãƒ‡ãƒ¢ï¼‰")

    if "manual_score" not in st.session_state:
        st.session_state.manual_score = [50, 50, 50]

    new_scores = []
    for i, row in df_demo.iterrows():
        v = st.number_input(
            f"{row['é¦¬å']} ã®ã‚¹ã‚³ã‚¢",
            min_value=0,
            max_value=100,
            value=st.session_state.manual_score[i],
            key=f"score_{i}",
        )
        new_scores.append(v)

    st.session_state.manual_score = new_scores

    df_out = df_demo.copy()
    df_out["æ‰‹å‹•ã‚¹ã‚³ã‚¢"] = st.session_state.manual_score

    st.write("ã‚¹ã‚³ã‚¢ä»˜ãå‡ºé¦¬è¡¨ï¼ˆãƒ‡ãƒ¢ï¼‰ï¼š")
    st.dataframe(df_out, use_container_width=True)

# ---------------------------------------------------
# AIã‚¹ã‚³ã‚¢ã‚¿ãƒ–
# ---------------------------------------------------
with tab_ai:
    st.subheader("ğŸ¤– AIã‚¹ã‚³ã‚¢ã‚¿ãƒ–ï¼ˆä¸­èº«ãƒ†ã‚¹ãƒˆï¼‰")
    st.info("ã“ã“ã«AIã‚¹ã‚³ã‚¢ã®çµæœãƒ†ãƒ¼ãƒ–ãƒ«ãŒå…¥ã‚Šã¾ã™ã€‚ï¼ˆä»Šã¯ãƒ‡ãƒ¢ï¼‰")
    df_ai = df_demo.copy()
    df_ai["AIã‚¹ã‚³ã‚¢ï¼ˆä»®ï¼‰"] = [72, 65, 80]
    st.dataframe(df_ai, use_container_width=True)

# ---------------------------------------------------
# é¦¬åˆ¸ã‚¿ãƒ–
# ---------------------------------------------------
with tab_baken:
    st.subheader("ğŸ’´ é¦¬åˆ¸ã‚¿ãƒ–ï¼ˆä¸­èº«ãƒ†ã‚¹ãƒˆï¼‰")
    st.write("ã“ã“ã«é¦¬åˆ¸ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚„è²·ã„ç›®è¡¨ç¤ºãŒå…¥ã‚Šã¾ã™ã€‚ï¼ˆä»Šã¯ãƒ‡ãƒ¢ï¼‰")

    budget = st.number_input("äºˆç®—ï¼ˆå††ï¼‰", min_value=0, step=500, value=2000)
    st.write(f"ç¾åœ¨ã®ä»®äºˆç®—ï¼š{budget} å††")

    st.write("ä»®ã®è²·ã„ç›®ä¾‹ï¼š")
    st.markdown("- 3é€£è¤‡ 1-2-3  500å††\n- é¦¬é€£ 1-3  800å††\n- å˜å‹ 3  700å††")

# ---------------------------------------------------
# åŸºæœ¬æƒ…å ±ã‚¿ãƒ–
# ---------------------------------------------------
with tab_info:
    st.subheader("â„¹ï¸ åŸºæœ¬æƒ…å ±ã‚¿ãƒ–ï¼ˆä¸­èº«ãƒ†ã‚¹ãƒˆï¼‰")
    st.write("ã“ã“ã«ãƒ¬ãƒ¼ã‚¹å / é–‹å‚¬ / å¤©å€™ / é¦¬å ´çŠ¶æ…‹ãªã©ãŒå…¥ã‚Šã¾ã™ã€‚ï¼ˆä»Šã¯ãƒ‡ãƒ¢ï¼‰")

    st.markdown(
        """
        - ãƒ¬ãƒ¼ã‚¹åï¼šã‚µãƒ³ãƒ—ãƒ«ã‚¹ãƒ†ãƒ¼ã‚¯ã‚¹
        - é–‹å‚¬ï¼šä¸­å±± æ—¥æ›œ 11R
        - è·é›¢ï¼šèŠ2000m
        - å‡ºèµ°é ­æ•°ï¼š3é ­ï¼ˆãƒ‡ãƒ¢ï¼‰
        """
    )
